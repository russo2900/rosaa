<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ramo C√≥smico üíñ</title>

<style>
*{box-sizing:border-box}
body{
    margin:0;
    overflow:hidden;
    background:black;
    color:white;
    font-family:Arial, sans-serif;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    height:100vh;
}

/* ===== GALAXIA ===== */
canvas{
    position:fixed;
    inset:0;
    z-index:-5;
}

/* ===== LUNA BONITA CON TEXTURA ===== */
#moon {
    position: fixed;
    top: 10%;
    right: 10%;
    width: 150px;
    height: 150px;
    background: radial-gradient(circle at 30% 30%, #ffffff, #e0e0e0, #b0b0b0);
    border-radius: 50%;
    box-shadow: 0 0 50px rgba(255, 255, 255, 0.8), inset -20px -20px 0 rgba(200, 200, 200, 0.5);
    z-index: -4;
    animation: moonGlow 4s ease-in-out infinite alternate;
}
@keyframes moonGlow {
    0% { box-shadow: 0 0 50px rgba(255, 255, 255, 0.8), inset -20px -20px 0 rgba(200, 200, 200, 0.5); }
    100% { box-shadow: 0 0 80px rgba(255, 255, 255, 1), inset -20px -20px 0 rgba(220, 220, 220, 0.7); }
}
/* Textura de la luna: cr√°teres simulados */
#moon::before {
    content: '';
    position: absolute;
    top: 20%;
    left: 30%;
    width: 20px;
    height: 20px;
    background: rgba(150, 150, 150, 0.3);
    border-radius: 50%;
    box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.5);
}
#moon::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 60%;
    width: 15px;
    height: 15px;
    background: rgba(120, 120, 120, 0.4);
    border-radius: 50%;
    box-shadow: inset 0 0 3px rgba(0, 0, 0, 0.5);
}

/* ===== CONTADOR ===== */
.countdown{
    font-size:32px;
    margin-bottom:20px;
    text-shadow:0 0 25px crimson;
    z-index:5;
}/* ===== RAMO ===== */
.bouquet{
    position:relative;
    width:600px;
    height:350px;
    display:flex;
    justify-content:center;
    align-items:flex-end;
    gap:60px;
    z-index:2;
}

/* ===== ROSA ===== */
.rose{
    position:relative;
    width:140px;
    height:160px;
    transform-style:preserve-3d;
    transform:rotateX(20deg);
    animation:float 6s ease-in-out infinite;
    opacity:0;
    transition:opacity 3s ease;
    cursor:pointer;
    filter: drop-shadow(0 0 10px rgba(255, 0, 0, 0.5));
    
    pointer-events: none; /* üîí BLOQUEA clicks antes del desbloqueo */
}

@keyframes float{
    0%,100%{transform:rotateX(20deg) translateY(0)}
    50%{transform:rotateX(20deg) translateY(-12px)}
}

.rose.unlocked{
    opacity:1;
    pointer-events: auto; /* üîì Activa clicks solo cuando est√° desbloqueada */
}

/* ===== P√âTALOS ===== */
.petal{
    position:absolute;
    width:70px;
    height:90px;
    border-radius:50% 50% 45% 45%;
    top:50%;
    left:50%;
    transform-origin:bottom center;
    transform:translate(-50%,-100%) scale(0);
    background:radial-gradient(circle at 40% 30%, #ff6b6b, #800000);
    box-shadow:0 0 25px rgba(255,0,0,0.6);
    transition:transform 2.5s ease;
    z-index:2;
}

/* CAPA EXTERNA */
.rose.unlocked .petal:nth-child(1){ transform:translate(-50%,-100%) rotate(0deg) translateY(-35px) scale(1);}
.rose.unlocked .petal:nth-child(2){ transform:translate(-50%,-100%) rotate(60deg) translateY(-35px) scale(1);}
.rose.unlocked .petal:nth-child(3){ transform:translate(-50%,-100%) rotate(120deg) translateY(-35px) scale(1);}
.rose.unlocked .petal:nth-child(4){ transform:translate(-50%,-100%) rotate(180deg) translateY(-35px) scale(1);}
.rose.unlocked .petal:nth-child(5){ transform:translate(-50%,-100%) rotate(240deg) translateY(-35px) scale(1);}
.rose.unlocked .petal:nth-child(6){ transform:translate(-50%,-100%) rotate(300deg) translateY(-35px) scale(1);}

/* CAPA INTERNA */
.inner{
    background:radial-gradient(circle at 40% 30%, #ff9999, #990000);
    width:50px;
    height:70px;
    z-index:3;
}

.rose.unlocked .inner:nth-child(7){ transform:translate(-50%,-100%) rotate(30deg) translateY(-35px) scale(1);}
.rose.unlocked .inner:nth-child(8){ transform:translate(-50%,-100%) rotate(150deg) translateY(-35px) scale(1);}
.rose.unlocked .inner:nth-child(9){ transform:translate(-50%,-100%) rotate(270deg) translateY(-35px) scale(1);}

/* CENTRO */
.center{
    position:absolute;
    width:80px;
    height:80px;
    background:radial-gradient(circle,#660000,#330000);
    border-radius:50%;
    top:60%;
    left:50%;
    transform:translate(-50%,-70%) scale(0);
    transition:transform 2.5s ease;
    z-index:3;
}

.rose.unlocked .center{
    transform:translate(-50%,-70%) scale(1);
}

/* TALLO */
.stem{
    position:absolute;
    width:14px;
    height:180px;
    background:linear-gradient(#2c8b57,#004d00);
    bottom:-100px;
    left:50%;
    transform:translateX(-50%);
    border-radius:5px;
    box-shadow:0 0 10px rgba(0,255,0,0.4);
    z-index:0;
}

/* HOJAS EN LOS TALLOS */
.stem::before {
    content: '';
    position: absolute;
    bottom: 50px;
    left: -10px;
    width: 20px;
    height: 40px;
    background: linear-gradient(45deg, #228b22, #32cd32);
    border-radius: 50% 0 50% 0;
    transform: rotate(-20deg);
    box-shadow: 0 0 5px rgba(0, 128, 0, 0.5);
}
.stem::after {
    content: '';
    position: absolute;
    bottom: 80px;
    right: -10px;
    width: 20px;
    height: 40px;
    background: linear-gradient(45deg, #228b22, #32cd32);
    border-radius: 0 50% 0 50%;
    transform: rotate(20deg);
    box-shadow: 0 0 5px rgba(0, 128, 0, 0.5);
}

/* ===== TEXTO ===== */
.message{
    margin-top:30px;
    font-size:32px;
    letter-spacing:2px;
    text-shadow:0 0 35px red;
    min-height:40px;
    z-index:5;
    opacity: 0;
    animation: fadeIn 2s ease-in-out forwards; /* Fade suave */
}
@keyframes fadeIn {
    0% { opacity: 0; transform: translateY(20px); }
    100% { opacity: 1; transform: translateY(0); }
}

.music-btn{
    display:none;
    position:fixed;   /* üëà clave */
    bottom:80px;      /* üëà lo mueve abajo */
    left:50%;
    transform:translateX(-50%);
    padding:12px 28px;
    background:linear-gradient(45deg,#a00000,#ff4d4d);
    border:none;
    color:white;
    border-radius:30px;
    cursor:pointer;
    box-shadow:0 0 25px crimson;
    font-size:16px;
    z-index:20;
}
.music-btn.show{display:block}

/* ===== P√âTALOS CAYENDO ===== */
#falling-petals {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: -1;
}
.petal-fall {
    position: absolute;
    width: 20px;
    height: 30px;
    background: radial-gradient(circle, #ff6b6b, #800000);
    border-radius: 50% 50% 45% 45%;
    opacity: 0.8;
    animation: fall linear infinite;
}
@keyframes fall {
    0% { transform: translateY(-100vh) rotate(0deg); }
    100% { transform: translateY(100vh) rotate(360deg); }
}

/* ===== CHISPAS M√ÅGICAS ===== */
#sparkles {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: -2;
}
.sparkle {
    position: absolute;
    width: 4px;
    height: 4px;
    background: radial-gradient(circle, #ffffff, #ffff00, transparent);
    border-radius: 50%;
    animation: sparkleFloat 3s ease-in-out infinite;
    box-shadow: 0 0 10px rgba(255, 255, 0, 0.8);
}
@keyframes sparkleFloat {
    0%, 100% { transform: translateY(0) scale(1); opacity: 1; }
    50% { transform: translateY(-20px) scale(1.2); opacity: 0.7; }
}

/* ===== CORAZONES EXPLOSI√ìN ===== */
@keyframes explode {
    0% { transform: translate(0, 0) scale(1); opacity: 1; }
    100% { transform: translate(var(--tx), var(--ty)) scale(0.5); opacity: 0; }
}

/* ===== CARTA ANIMADA ===== */
#letter {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) scale(0);
    width: 400px;
    height: 300px;
    background: linear-gradient(135deg, #ffcccc, #ff9999);
    border-radius: 10px;
    box-shadow: 0 0 50px rgba(255, 0, 0, 0.5);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    z-index: 100;
    opacity: 0;
    transition: all 0.5s ease;
    font-family: 'Courier New', monospace;
    color: #330000;
    text-align: center;
    padding: 20px;
    overflow-y: auto;
}
#letter.open {
    transform: translate(-50%, -50%) scale(1);
    opacity: 1;
}
#letter .close-btn {
    position: absolute;
    top: 10px;
    right: 10px;
    background: #ff4d4d;
    color: white;
    border: none;
    border-radius: 50%;
    width: 30px;
    height: 30px;
    cursor: pointer;
    font-size: 16px;
}

/* ===== RESPONSIVE ===== */
@media (max-width: 768px) {
    .bouquet { width: 100%; gap: 20px; }
    .rose { width: 100px; height: 120px; }
    .countdown, .message { font-size: 24px; }
    .music-btn { bottom: 60px; padding: 10px 20px; font-size: 14px; }
    #letter { width: 90%; height: 250px; font-size: 18px; }
    #moon { width: 100px; height: 100px; }
}
</style>
</head>

<body>

<canvas id="galaxy"></canvas>
<div id="moon"></div> <!-- Luna bonita con textura -->
<div id="falling-petals"></div> <!-- Para p√©talos cayendo -->
<div id="sparkles"></div> <!-- Chispas m√°gicas -->
<div id="countdown" class="countdown">Calculando...</div>

<div class="bouquet">

    <div class="rose">
        <div class="petal"></div>
        <div class="petal"></div>
        <div class="petal"></div>
        <div class="petal"></div>
        <div class="petal"></div>
        <div class="petal"></div>

        <div class="petal inner"></div>
        <div class="petal inner"></div>
        <div class="petal inner"></div>

        <div class="center"></div>
        <div class="stem"></div>
    </div>

    <div class="rose">
        <div class="petal"></div><div class="petal"></div><div class="petal"></div>
        <div class="petal"></div><div class="petal"></div><div class="petal"></div>
        <div class="petal inner"></div><div class="petal inner"></div><div class="petal inner"></div>
        <div class="center"></div>
        <div class="stem"></div>

    </div>

    <div class="rose">
        <div class="petal"></div><div class="petal"></div><div class="petal"></div>
        <div class="petal"></div><div class="petal"></div><div class="petal"></div>
        <div class="petal inner"></div><div class="petal inner"></div><div class="petal inner"></div>
        <div class="center"></div>
        <div class="stem"></div>
    </div>

</div>

<div id="message" class="message"></div>
<div id="letter">
    <button class="close-btn" onclick="closeLetter()">√ó</button>
    <p>Si vos me lo permit√≠s, yo siempre voy a estar en estos 3 lugares:<br>
    adelante tuyo para cuidarte<br>
    atr√°s tuyo para animarte siempre que lo necesites<br>
    y al lado tuyo para acompa√±arte en los momentos malos y los buenos<br>
    para darte un empujoncito siempre que lo necesites, para ser tu consejero, tu compa√±ero y todo lo que necesites incluso cuando el mundo se te venga abajo<br>
    de esta manera te pregunto, ¬øme dejar√≠as acompa√±arte y poder llevar con orgullo el t√≠tulo de tu pareja?</p>
</div>
<button id="musicBtn" class="music-btn" onclick="toggleMusic()">‚ñ∂ Reproducir m√∫sica</button>
<input id="volume" type="range" min="0" max="1" step="0.1" value="0.5" onchange="setVolume()" style="position:fixed; bottom:40px; left:50%; transform:translateX(-50%); z-index:20; display:none;">
<audio id="song" src="carencias.mp3"></audio>

<script>
/* ===== GALAXIA EN MOVIMIENTO ===== */
const canvas = document.getElementById("galaxy");
const ctx = canvas.getContext("2d");

let w, h;
let stars = [];

function resize(){
    w = canvas.width = window.innerWidth;
    h = canvas.height = window.innerHeight;
    stars = [];

    for(let i=0;i<900;i++){
        stars.push({
            x: Math.random()*w,
            y: Math.random()*h,
            size: Math.random()*2 + 0.5,
            speed: Math.random()*0.5 + 0.1,
            opacity: Math.random()
        });
    }
}
window.onresize = resize;
resize();

function animate(){
    ctx.fillStyle = "rgba(5,0,20,0.6)";
    ctx.fillRect(0,0,w,h);

    for(let s of stars){

        /* movimiento hacia abajo */
        s.y += s.speed;

        /* si sale de pantalla reaparece arriba */
        if(s.y > h){
            s.y = 0;
            s.x = Math.random()*w;
        }

        /* peque√±o efecto brillo */
        s.opacity += (Math.random()-0.5)*0.05;
        if(s.opacity < 0.2) s.opacity = 0.2;
        if(s.opacity > 1) s.opacity = 1;

        ctx.fillStyle = `rgba(255,255,255,${s.opacity})`;
        ctx.fillRect(s.x, s.y, s.size, s.size);
    }

    requestAnimationFrame(animate);
}
animate();

/* ===== P√âTALOS CAYENDO ===== */
function createFallingPetals() {
    const container = document.getElementById('falling-petals');
    setInterval(() => {
        const petal = document.createElement('div');
        petal.classList.add('petal-fall');
        petal.style.left = Math.random() * 100 + '%';
        petal.style.animationDuration = (Math.random() * 5 + 5) + 's'; // Entre 5-10s
        container.appendChild(petal);
        setTimeout(() => petal.remove(), 10000); // Remover despu√©s de 10s
    }, 500); // Nuevo p√©talo cada 0.3s
}
createFallingPetals();

/* ===== INTERACTIVIDAD: CLIC EN ROSAS ===== */
document.querySelectorAll('.rose').forEach(rose => {
    rose.addEventListener('click', () => {
        openLetter();
        // Cambia el color temporalmente
        rose.style.filter = 'hue-rotate(45deg)';
        setTimeout(() => rose.style.filter = '', 1000);
    });
});

/* ===== CARTA ANIMADA ===== */
function openLetter() {
    const letter = document.getElementById('letter');
    letter.classList.add('open');
}

function closeLetter() {
    const letter = document.getElementById('letter');
    letter.classList.remove('open');
}

/* ===== CORAZONES EXPLOSI√ìN ===== */
function generateHearts() {
    const bouquet = document.querySelector('.bouquet');
    const rect = bouquet.getBoundingClientRect();
    const centerX = rect.left + rect.width / 2;
    const centerY = rect.top + rect.height / 2;

    for (let i = 0; i < 20; i++) { // Genera 20 corazones
        const heart = document.createElement('div');
        heart.textContent = 'üíñ';
        heart.style.position = 'absolute';
        heart.style.fontSize = '24px';
        heart.style.left = centerX + 'px';
        heart.style.top = centerY + 'px';
        heart.style.zIndex = '10';

        // Calcular direcci√≥n aleatoria para la explosi√≥n
        const angle = Math.random() * 2 * Math.PI; // √Ångulo aleatorio
        const distance = Math.random() * 300 + 100; // Distancia aleatoria (100-400px)
        const tx = Math.cos(angle) * distance;
        const ty = Math.sin(angle) * distance;

        heart.style.setProperty('--tx', tx + 'px');
        heart.style.setProperty('--ty', ty + 'px');
        heart.style.animation = 'explode 3s ease-out forwards';

        document.body.appendChild(heart);
        setTimeout(() => heart.remove(), 3000);
    }
}

/* M√öSICA */
const song = document.getElementById('song');
function toggleMusic() {
    if (song.paused) {
        song.play();
        document.getElementById('musicBtn').textContent = '‚è∏ Pausar m√∫sica';
    } else {
        song.pause();
        document.getElementById('musicBtn').textContent = '‚ñ∂ Reproducir m√∫sica';
    }
}
function setVolume() {
    song.volume = document.getElementById('volume').value;
}

/* TEXTO */
function typeText(text){
const el=document.getElementById("message");
el.textContent="";
let i=0;
const t=setInterval(()=>{
el.textContent+=text[i];
i++;
if(i>=text.length)clearInterval(t);
},100);
}

/* DESBLOQUEO */
function unlock(){
    document.querySelectorAll(".rose").forEach(r=>r.classList.add("unlocked"));
    document.getElementById("musicBtn").classList.add("show");
    document.getElementById("volume").style.display = "block"; // Mostrar control de volumen

    typeText(`Toca una rosa para leer la carta.`);

    generateHearts(); // Generar explosi√≥n de corazones al desbloquear
    song.play().catch(() => {}); // Intentar auto-play

    localStorage.setItem("roseUnlocked","true");
}
/* CONTADOR */
const countdown=document.getElementById("countdown");
const TARGET=new Date(new Date().getFullYear(),1,14,0,0,0);

function update(){
if(localStorage.getItem("roseUnlocked")){
countdown.textContent="üíòuna florcita para tiüíò";
unlock();
clearInterval(timer);
return;
}

const now=new Date();
const diff=TARGET-now;

if(diff<=0){
countdown.textContent="üíñ Desbloqueado üíñ";
unlock();
clearInterval(timer);
return;
}

const d=Math.floor(diff/86400000);
const h=Math.floor(diff/3600000)%24;
const m=Math.floor(diff/60000)%60;
const s=Math.floor(diff/1000)%60;

countdown.textContent=
`${d.toString().padStart(2,"0")}:${h.toString().padStart(2,"0")}:${m.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`;
}

// Desbloquear el bot√≥n de m√∫sica inmediatamente
document.getElementById("musicBtn").classList.add("show");
document.getElementById("volume").style.display = "block";

const timer=setInterval(update,1000);
update();
</script>

</body>
</html>
